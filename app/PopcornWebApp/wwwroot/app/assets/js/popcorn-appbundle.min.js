!function(){"use strict";angular.module("popcorn",["ngResource","ngAria","ngMaterial","ngMdIcons","ngCookies","ngAnimate","ngSanitize","ui.router","home","popular","trending","recent","infinite-scroll","movie","angular-imagefit","jkAngularRatingStars","SignalR","player","underscore","login","LocalStorageModule","azure"])}(),function(){"use strict";function a(a,b,c,d,e,f){f.setPrefix("popcorn").setStorageType("sessionStorage").setNotify(!0,!0),c.html5Mode(!0),e.theme("docs-dark","default").primaryPalette("orange").dark(),b.otherwise("/trending")}function b(a,b,c){a.previousParams,a.previousState,a.currentState,c.clearAll(),a.$on("$stateChangeSuccess",function(d,e,f,g,h){return a.previousParams=h,a.previousState=g.name,a.currentState=e.name,null===c.get("userId")||null===c.get("mobileServiceAuthenticationToken")?(d.preventDefault(),void b.go("login")):void 0})}angular.module("popcorn").constant("AzureMobileServiceClient",{API_URL:"https://popcornapi.azurewebsites.net/",API_KEY:"B17B3E4ED4632B9E63F37392A86BB767F5D20010412F68A993E97CC918716F13"}).config(a).run(b),angular.module("infinite-scroll").value("THROTTLE_MILLISECONDS",1e3),a.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","$mdThemingProvider","localStorageServiceProvider"],b.$inject=["$rootScope","$state","localStorageService"]}(),function(){"use strict";angular.module("azure",[])}(),function(){"use strict";angular.module("home",[])}(),function(){"use strict";angular.module("login",[])}(),function(){"use strict";angular.module("movie",[])}(),function(){"use strict";angular.module("player",["ngResource"])}(),function(){"use strict";angular.module("popular",["ngResource"])}(),function(){"use strict";angular.module("recent",["ngResource"])}(),function(){"use strict";angular.module("SignalR",[])}(),function(){"use strict";angular.module("trending",["ngResource"])}(),function(){"use strict";angular.module("underscore",[])}(),angular.module("popcorn").config(["$stateProvider",function(a){a.state("home",{url:"","abstract":!0,templateUrl:"app/modules/home/home.html",controller:"HomeCtrl",controllerAs:"vm"})}]),angular.module("login").config(["$stateProvider",function(a){a.state("login",{url:"/login",templateUrl:"app/modules/login/login.html",controller:"LoginCtrl",controllerAs:"vm"})}]),angular.module("movie").config(["$stateProvider",function(a){a.state("home.movie",{url:"/movie/:slug",templateUrl:"app/modules/movie/movie.html",controller:"MovieCtrl",controllerAs:"vm",params:{id:null}})}]),angular.module("player").config(["$stateProvider",function(a){a.state("home.player",{url:"/movie/:slug/play",templateUrl:"app/modules/player/player.html",controller:"PlayerCtrl",controllerAs:"vm",params:{movie:null}})}]),angular.module("popular").config(["$stateProvider",function(a){a.state("home.popular",{url:"/popular",templateUrl:"app/modules/popular/popular.html",controller:"PopularCtrl",controllerAs:"vm"})}]),angular.module("recent").config(["$stateProvider",function(a){a.state("home.recent",{url:"/recent",templateUrl:"app/modules/recent/recent.html",controller:"RecentCtrl",controllerAs:"vm"})}]),angular.module("trending").config(["$stateProvider",function(a){a.state("home.trending",{url:"/trending",templateUrl:"app/modules/trending/trending.html",controller:"TrendingCtrl",controllerAs:"vm"})}]),function(){"use strict";function a(){}angular.module("popcorn").controller("HomeCtrl",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){var j=this;j.loading=!1,f.$on("loading",function(){j.loading=!0}),f.$on("loaded",function(){j.loading=!1}),j.tabIndex=c.current.name,f.$on("$stateChangeSuccess",function(a,b){j.tabIndex=b.name}),j.toggleSidenav=function(b){a(b).toggle()},j.querySearch=function(a){var b=h.defer();return g.search(a).$promise.then(function(a){0===a.data.movie_count?b.resolve([]):b.resolve(a.data.movies)}),b.promise},j.searchTextChange=function(a){},j.selectedItemChange=function(a){j.showSearch=!1,j.searchText="",void 0!==a&&c.go("home.movie",{id:a.id,slug:a.slug})}}angular.module("popcorn").controller("LayoutCtrl",a),a.$inject=["$mdSidenav","$cookies","$state","$mdToast","$mdDialog","$rootScope","SearchService","$q","$timeout"]}(),function(){"use strict";function a(a,b,c,d,e){var f=this;f.authenticate=function(a){var f=e.getMobileService();f.login(a).then(function(a){c.set("userId",a.userId),c.set("mobileServiceAuthenticationToken",a.mobileServiceAuthenticationToken),null!==d.previousState?b.go(d.previousState):b.go("home.trending")})}}angular.module("login").controller("LoginCtrl",a),a.$inject=["LoginService","$state","localStorageService","$rootScope","MobileServiceClient"]}(),function(){"use strict";function a(a,b,c,d,e,f){if(null===a.id)return void e.go("home.trending");var g=this;g.movie={},g.loaded=!1,g.goToPlayer=function(a){e.go("home.player",{slug:g.movie.slug,movie:g.movie})},b.getMovie(a.id).$promise.then(function(a){return g.movie=a.data.movie,g.movie.rating=Math.round(g.movie.rating/2),g.movie.genre=g.movie.genres.join(", "),b.getTMDbInfo(g.movie.imdb_code).$promise}).then(function(a){g.movie.background="https://image.tmdb.org/t/p/original"+a.movie_results[0].backdrop_path;var b=f.getMobileService();b.invokeApi("Movie",{method:"GET",parameters:{ytCode:g.movie.yt_trailer_code}}).then(function(a){g.movie.trailerUrl=a.result})})["catch"](function(a){g.loaded=!0}),g.imageLoaded=function(){c.$apply(function(){g.loaded=!0,d(function(){$(window).trigger("resize")})})},g.check={scale:"best-fill",onLoad:function(a,b){},onError:function(a,b){},onStart:function(a,b){},align:"center",parent:null,hideParentOverflow:!0,fadeInDuration:400,rescaleOnResize:!0,didScale:function(a,b){}}}angular.module("movie").controller("MovieCtrl",a),a.$inject=["$stateParams","MovieService","$scope","$timeout","$state","MobileServiceClient"]}(),function(){"use strict";function a(a,b,c,d,e,f,g){var h=this;if(null===c.movie)return void d.go("home.trending");h.loaded=!1,h.check={scale:"best-fill",onLoad:function(a,b){},onError:function(a,b){},onStart:function(a,b){},align:"center",parent:null,hideParentOverflow:!0,fadeInDuration:400,rescaleOnResize:!0,didScale:function(a,b){}},h.imageLoaded=function(){f.$apply(function(){h.loaded=!0,g(function(){$(window).trigger("resize")})})},h.goPrevious=function(){d.go(b.previousState,b.previousParams)},h.movie=c.movie;var i=e(e.defaultServer,"PopcornHub");i.on("DownloadRateChanged",function(a){}),i.on("DownloadProgressChanged",function(a){}),i.on("MovieUpdated",function(a){}),i.on("MovieFailed",function(a){});_.first(_.where(h.movie.torrents,{size_bytes:_.min(_.pluck(h.movie.torrents,"size_bytes"))}))}angular.module("player").controller("PlayerCtrl",a),a.$inject=["PlayerService","$rootScope","$stateParams","$state","Hub","$scope","$timeout"]}(),function(){"use strict";function a(a,b){var c=this;c.page=0,c.movies=[];var d=function(d){a.getMovies(d).$promise.then(function(a){if(c.page!==a.data.page_number){c.page=a.data.page_number;for(var d=0;d<a.data.movies.length;d++)c.movies.push(a.data.movies[d]);b.$broadcast("loaded")}})["catch"](function(a){b.$broadcast("loaded")})};c.paginate=function(){b.$broadcast("loading"),d(c.page+1)}}angular.module("popular").controller("PopularCtrl",a),a.$inject=["PopularService","$rootScope"]}(),function(){"use strict";function a(a,b){var c=this;c.page=0,c.movies=[];var d=function(d){a.getMovies(d).$promise.then(function(a){if(c.page!==a.data.page_number){c.page=a.data.page_number;for(var d=0;d<a.data.movies.length;d++)c.movies.push(a.data.movies[d]);b.$broadcast("loaded")}})["catch"](function(a){b.$broadcast("loaded")})};c.paginate=function(){b.$broadcast("loading"),d(c.page+1)}}angular.module("recent").controller("RecentCtrl",a),a.$inject=["RecentService","$rootScope"]}(),function(){"use strict";function a(a,b){var c=this;c.page=0,c.movies=[];var d=function(d){a.getMovies(d).$promise.then(function(a){if(c.page!==a.data.page_number){c.page=a.data.page_number;for(var d=0;d<a.data.movies.length;d++)c.movies.push(a.data.movies[d]);b.$broadcast("loaded")}})["catch"](function(a){b.$broadcast("loaded")})};c.paginate=function(){b.$broadcast("loading"),d(c.page+1)}}angular.module("trending").controller("TrendingCtrl",a),a.$inject=["TrendingService","$rootScope"]}(),function(){"use strict";angular.module("azure").service("MobileServiceClient",function(){var a=new WindowsAzure.MobileServiceClient("https://popcornapi.azurewebsites.net");this.getMobileService=function(){return a}})}(),function(){"use strict";function a(a){return{search:function(b){return a("https://yts.ag/api/v2/list_movies.json").get({query_term:b})}}}angular.module("popular").factory("SearchService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(){return{}}angular.module("login").factory("LoginService",a),a.$inject=[]}(),function(){"use strict";function a(a){return{getMovie:function(b){return a("https://yts.ag/api/v2/movie_details.json").get({movie_id:b,with_images:"true",with_cast:"true"})},getTMDbInfo:function(b){return a("https://api.themoviedb.org/3/find/:id").get({api_key:"a21fe922d3bac6654e93450e9a18af1c",id:b,external_source:"imdb_id"})}}}angular.module("movie").factory("MovieService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://yts.ag/api/v2/list_movies.json").get({sort_by:"download_count",page:b,limit:"30"})}}}angular.module("player").factory("PlayerService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://yts.ag/api/v2/list_movies.json").get({sort_by:"rating",page:b,limit:"30"})}}}angular.module("popular").factory("PopularService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://yts.ag/api/v2/list_movies.json").get({sort_by:"date_added",page:b,limit:"30"})}}}angular.module("recent").factory("RecentService",a),a.$inject=["$resource"]}(),function(){"use strict";angular.module("SignalR").constant("$",$).constant("backendServerUrl","http://popcorn.westeurope.cloudapp.azure.com").factory("Hub",["$","$rootScope","backendServerUrl",function(a,b,c){function d(d,e){var f=a.hubConnection(c),g=f.createHubProxy(e);return f.start().done(function(){}),{on:function(a,c){g.on(a,function(a){b.$apply(function(){c&&c(a)})})},invoke:function(a,c){g.invoke(a).done(function(a){b.$apply(function(){c&&c(a)})})},invokeWithArgs:function(a){g.invoke.apply(g,arguments).done(function(a){})}}}return d}])}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://yts.ag/api/v2/list_movies.json").get({sort_by:"download_count",page:b,limit:"30"})}}}angular.module("trending").factory("TrendingService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(){return window._}angular.module("underscore").factory("UnderscoreService",a),a.$inject=[""]}(),function(){"use strict";angular.module("popcorn").directive("imageonload",function(){return{restrict:"A",scope:{imgloaded:"&"},link:function(a,b,c){b.bind("load",function(){a.imgloaded()}),b.bind("error",function(){})}}})}();