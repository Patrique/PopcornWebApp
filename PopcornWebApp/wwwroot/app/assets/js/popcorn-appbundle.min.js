!function(){"use strict";angular.module("popcorn",["ngResource","ngAria","ngMaterial","ngMdIcons","ngCookies","ngAnimate","ngSanitize","ui.router","home","popular","trending","recent","infinite-scroll","movie","angular-imagefit","jkAngularRatingStars","SignalR","player","underscore","LocalStorageModule","com.2fdevs.videogular","com.2fdevs.videogular.plugins.controls","com.2fdevs.videogular.plugins.overlayplay","com.2fdevs.videogular.plugins.poster"])}(),function(){"use strict";function a(a,b,c,d,e,f){f.setPrefix("popcorn").setStorageType("localStorage").setNotify(!0,!0),c.html5Mode(!0),e.theme("docs-dark","default").primaryPalette("orange").dark(),b.otherwise(function(a){var b=a.get("$state");b.go("home.popular")})}function b(a,b,c){a.previousParams,a.previousState,a.currentState,a.$on("$stateChangeStart",function(b,c,d,e,f){a.previousParams=f,a.previousState=e.name,a.currentState=c.name,"home.player"===e.name&&a.$broadcast("HomePlayerExited")})}angular.module("popcorn").config(a).run(b),angular.module("infinite-scroll").value("THROTTLE_MILLISECONDS",1e3),a.$inject=["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider","$mdThemingProvider","localStorageServiceProvider"],b.$inject=["$rootScope","$state","localStorageService"]}(),function(){"use strict";angular.module("home",[])}(),function(){"use strict";angular.module("movie",[])}(),function(){"use strict";angular.module("player",["ngResource"])}(),function(){"use strict";angular.module("popular",["ngResource"])}(),function(){"use strict";angular.module("recent",["ngResource"])}(),function(){"use strict";angular.module("SignalR",[])}(),function(){"use strict";angular.module("trending",["ngResource"])}(),function(){"use strict";angular.module("underscore",[])}(),angular.module("popcorn").config(["$stateProvider",function(a){a.state("home",{url:"","abstract":!0,templateUrl:"app/modules/home/home.html",controller:"HomeCtrl",controllerAs:"vm"})}]),angular.module("movie").config(["$stateProvider",function(a){a.state("home.movie",{url:"/movie/:slug",templateUrl:"app/modules/movie/movie.html",controller:"MovieCtrl",controllerAs:"vm",params:{imdb_code:null}})}]),angular.module("player").config(["$stateProvider",function(a){a.state("home.player",{url:"/movie/:slug/play",templateUrl:"app/modules/player/player.html",controller:"PlayerCtrl",controllerAs:"vm",params:{movie:null}})}]),angular.module("popular").config(["$stateProvider",function(a){a.state("home.popular",{url:"/popular",templateUrl:"app/modules/popular/popular.html",controller:"PopularCtrl",controllerAs:"vm"})}]),angular.module("recent").config(["$stateProvider",function(a){a.state("home.recent",{url:"/recent",templateUrl:"app/modules/recent/recent.html",controller:"RecentCtrl",controllerAs:"vm"})}]),angular.module("trending").config(["$stateProvider",function(a){a.state("home.trending",{url:"/trending",templateUrl:"app/modules/trending/trending.html",controller:"TrendingCtrl",controllerAs:"vm"})}]),function(){"use strict";function a(){}angular.module("popcorn").controller("HomeCtrl",a)}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){var j=this;j.loading=!1,f.$on("loading",function(){j.loading=!0}),f.$on("loaded",function(){j.loading=!1}),j.tabIndex=c.current.name,f.$on("$stateChangeSuccess",function(a,b){j.tabIndex=b.name}),j.toggleSidenav=function(b){a(b).toggle()},j.querySearch=function(a){var b=h.defer();return g.search(a).$promise.then(function(a){0===a.totalMovies?b.resolve([]):b.resolve(a.movies)}),b.promise},j.searchTextChange=function(a){},j.selectedItemChange=function(a){j.showSearch=!1,j.searchText="",void 0!==a&&c.go("home.movie",{imdb_code:a.imdb_code,slug:a.slug})}}angular.module("popcorn").controller("LayoutCtrl",a),a.$inject=["$mdSidenav","$cookies","$state","$mdToast","$mdDialog","$rootScope","SearchService","$q","$timeout"]}(),function(){"use strict";function a(a,b,c,d,e,f){if(null===a.imdb_code)return void e.go("home.trending");var g=this;g.movie={},g.loaded=!1,g.goToPlayer=function(a){e.go("home.player",{slug:g.movie.slug,movie:g.movie})},g.config={sources:[],theme:"/app/assets/css/videogular-themes-default/videogular.css",plugins:{poster:g.movie.background}},b.getMovie(a.imdb_code).$promise.then(function(a){g.movie=a,g.movie.rating=Math.round(g.movie.rating/2),g.movie.genre=g.movie.genres.join(", "),b.getTrailer(g.movie.yt_trailer_code).$promise.then(function(a){g.movie.trailerUrl=a.trailer_url,g.config.sources=[{src:f.trustAsResourceUrl(g.movie.trailerUrl),type:"video/mp4"}]})}),g.imageLoaded=function(){c.$apply(function(){g.loaded=!0,d(function(){$(window).trigger("resize")})})},g.check={scale:"best-fill",onLoad:function(a,b){},onError:function(a,b){},onStart:function(a,b){},align:"center",parent:null,hideParentOverflow:!0,fadeInDuration:400,rescaleOnResize:!0,didScale:function(a,b){}}}angular.module("movie").controller("MovieCtrl",a),a.$inject=["$stateParams","MovieService","$scope","$timeout","$state","$sce"]}(),function(){"use strict";function a(a,b,c,d,e,f,g,h,i){var j=this;if(null===c.movie)return void d.go("home.trending");j.API=null,j.onPlayerReady=function(a){j.API=a,g(function(){j.API.play()})},j.movie=c.movie,j.config={sources:[],theme:"/app/assets/css/videogular-themes-default/videogular.css",plugins:{poster:j.movie.background}};var k=[];j.playerReady=!1,j.loaded=!1,j.serverBuffer=0,j.movieBuffer=0,j.check={scale:"best-fill",onLoad:function(a,b){},onError:function(a,b){},onStart:function(a,b){},align:"center",parent:null,hideParentOverflow:!0,fadeInDuration:400,rescaleOnResize:!0,didScale:function(a,b){}},j.imageLoaded=function(){f.$apply(function(){j.loaded=!0,g(function(){$(window).trigger("resize")})})},j.goPrevious=function(){d.go("home.movie",j.movie)},b.$on("StopMovie",function(){j.goPrevious()}),b.$on("HomePlayerExited",function(){l.stop()});var l=e("PopcornHub",j.movie.imdb_code);l.on("DownloadRateChanged",function(a){});var m=!1;l.on("DownloadProgressChanged",function(a){2>=a?j.serverBuffer=Math.round(50*a):j.serverBuffer=100,m||100!==j.serverBuffer||(m=!0,j.config.sources=k,j.playerReady=!0)}),l.on("MovieUpdated",function(a){null!==a.MovieFilePath&&(k=[{src:i.trustAsResourceUrl(a.MovieFilePath),type:"video/mp4"}])}),l.on("MovieFailed",function(a){console.log(a)}),l.start().then(function(){var a=_.first(_.where(j.movie.torrents,{size_bytes:_.min(_.pluck(j.movie.torrents,"size_bytes"))}));l.invokeWithArgs("Download",[a.url,j.movie.imdb_code],function(){})})}angular.module("player").controller("PlayerCtrl",a),a.$inject=["PlayerService","$rootScope","$stateParams","$state","Hub","$scope","$timeout","localStorageService","$sce"]}(),function(){"use strict";function a(a,b,c){var d=this;d.page=0,d.movies=[];var e=(c.keys(),function(e){a.getMovies(e).$promise.then(function(a){d.page++;for(var e=0;e<a.movies.length;e++){var f=a.movies[e],g=c.get(f.imdb_code);void 0!==g&&null!==g&&(f.like=g.like),d.movies.push(f)}b.$broadcast("loaded")})["catch"](function(a){b.$broadcast("loaded")})});d.paginate=function(){b.$broadcast("loading"),e(d.page+1)},d.toggleLike=function(a){void 0===a.like?a.like=!0:a.like=!a.like;var b={imdb_code:a.imdb_code,like:a.like,watched:!1};c.set(a.imdb_code,b)}}angular.module("popular").controller("PopularCtrl",a),a.$inject=["PopularService","$rootScope","localStorageService"]}(),function(){"use strict";function a(a,b,c){var d=this;d.page=0,d.movies=[];var e=function(e){a.getMovies(e).$promise.then(function(a){d.page++;for(var e=0;e<a.movies.length;e++){var f=a.movies[e],g=c.get(f.imdb_code);void 0!==g&&null!==g&&(f.like=g.like),d.movies.push(f)}b.$broadcast("loaded")})["catch"](function(a){b.$broadcast("loaded")})};d.paginate=function(){b.$broadcast("loading"),e(d.page+1)},d.toggleLike=function(a){void 0===a.like?a.like=!0:a.like=!a.like;var b={imdb_code:a.imdb_code,like:a.like,watched:!1};c.set(a.imdb_code,b)}}angular.module("recent").controller("RecentCtrl",a),a.$inject=["RecentService","$rootScope","localStorageService"]}(),function(){"use strict";function a(a,b,c){var d=this;d.page=0,d.movies=[];var e=function(e){a.getMovies(e).$promise.then(function(a){d.page++;for(var e=0;e<a.movies.length;e++){var f=a.movies[e],g=c.get(f.imdb_code);void 0!==g&&null!==g&&(f.like=g.like),d.movies.push(f)}b.$broadcast("loaded")})["catch"](function(a){b.$broadcast("loaded")})};d.paginate=function(){b.$broadcast("loading"),e(d.page+1)},d.toggleLike=function(a){void 0===a.like?a.like=!0:a.like=!a.like;var b={imdb_code:a.imdb_code,like:a.like,watched:!1};c.set(a.imdb_code,b)}}angular.module("trending").controller("TrendingCtrl",a),a.$inject=["TrendingService","$rootScope","localStorageService"]}(),function(){"use strict";function a(a){return{search:function(b){return a("https://popcornapi.azurewebsites.net/api/movies?page=1").get({query_term:b})}}}angular.module("popular").factory("SearchService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovie:function(b){return a("https://popcornapi.azurewebsites.net/api/movies/:id").get({id:b})},getTrailer:function(b){return a("https://popcornapi.azurewebsites.net/api/trailer/:yt_trailer_code").get({yt_trailer_code:b})}}}angular.module("movie").factory("MovieService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://yts.ag/api/v2/list_movies.json").get({sort_by:"download_count",page:b,limit:"30"})}}}angular.module("player").factory("PlayerService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://popcornapi.azurewebsites.net/api/movies").get({sort_by:"rating",page:b,limit:"30"})}}}angular.module("popular").factory("PopularService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://popcornapi.azurewebsites.net/api/movies").get({sort_by:"date_added",page:b,limit:"30"})}}}angular.module("recent").factory("RecentService",a),a.$inject=["$resource"]}(),function(){"use strict";angular.module("SignalR").constant("$",$).constant("backendServerUrl","https://server.popcorn.cool").factory("Hub",["$","$rootScope","backendServerUrl","$q","$timeout",function(a,b,c,d,e){function f(b,f){var g=a.hubConnection(c),h=g.createHubProxy(b);return h.connection.qs={ImdbCode:f},{start:function(){var a=d.defer();return g.start().done(function(){a.resolve()}).fail(function(b){a.reject()}),a.promise},stop:function(){g.stop()},on:function(a,b){h.on(a,function(a){e(function(){b&&b(a)})})},invoke:function(a,b){h.invoke(a).done(function(a){e(function(){b&&b(a)})}).fail(function(a){})},invokeWithArgs:function(a,b,c){b.unshift(a),h.invoke.apply(h,b).done(function(a){e(function(){c&&c(a)})}).fail(function(a){})}}}return f}])}(),function(){"use strict";function a(a){return{getMovies:function(b){return a("https://popcornapi.azurewebsites.net/api/movies").get({sort_by:"download_count",page:b,limit:"30"})}}}angular.module("trending").factory("TrendingService",a),a.$inject=["$resource"]}(),function(){"use strict";function a(){return window._}angular.module("underscore").factory("UnderscoreService",a),a.$inject=[""]}(),function(){"use strict";angular.module("popcorn").directive("imageonload",function(){return{restrict:"A",scope:{imgloaded:"&"},link:function(a,b,c){b.bind("load",function(){a.imgloaded()}),b.bind("error",function(){})}}})}(),function(){"use strict";angular.module("popcorn").directive("stopButton",["$rootScope",function(a){return{restrict:"E",require:"^videogular",template:"<div><md-icon md-svg-src='/app/assets/images/stop.svg' ng-click='stop();'></md-icon></div>",link:function(b,c,d){b.stop=function(){a.$broadcast("StopMovie")}}}}])}();